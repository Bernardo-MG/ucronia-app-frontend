<assoc-book-report-widget />
<p-card>
  <ng-template #header>
    <div class="row">
      <div class="col-sm-3">
        <!-- Add person -->
        <button type="button" class="btn btn-link" aria-label="register" routerLink="{{routerLink}}"
          [disabled]="!createPermission" [attr.aria-disabled]="!createPermission">
          <icon-add />
        </button>
      </div>
      <div class="col-sm-3">
        <select [disabled]="loading" class="form-select form-select-sm" aria-label="Filter person status"
          (change)="onChangeSource($event)">
          <option [selected]="source === 'games'" value="games">Juegos</option>
          <option [selected]="source === 'fiction'" value="fiction">Ficción</option>
        </select>
      </div>
    </div>
  </ng-template>
  <p-table lazy="true" dataKey="number" selectionMode="single" [loading]="loading" [value]="data.content"
    [(selection)]="selectedBook" paginator="true" [rows]="data.size" [totalRecords]="data.totalElements" [first]="first"
    (onSort)="onChangeDirection($event)" (onPage)="onPageChange($event)" showCurrentPageReport="true"
    currentPageReportTemplate="Total: {totalRecords}" (onRowSelect)="onSelectBook()">
    <ng-template #header>
      <tr>
        <th pSortableColumn="title">Título <p-sortIcon field="title" /></th>
        <th pSortableColumn="lent">Disponible <p-sortIcon field="lent" /></th>
      </tr>
    </ng-template>
    <ng-template #body let-book>
      <tr [pSelectableRow]="book">
        <td>
          <sup>{{book.title.supertitle}}</sup>
          {{book.title.title}}
          <sub>{{book.title.subtitle}}</sub>
        </td>
        <td>
          @switch (book.lent) {
          @case (true) {
          <span class="pi pi-times text-warning"></span>
          }
          @case (false) {
          <span class="pi pi-check text-success"></span>
          }
          }
        </td>
      </tr>
    </ng-template>
  </p-table>
</p-card>