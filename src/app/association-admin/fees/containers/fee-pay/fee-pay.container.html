<ui-article>
  <div uiResponsiveShortColumns>
    <p-card>
      <!-- Progress -->
      <div uiJustifyBetween>
        <button type="button" class="btn btn-link me-2" aria-label="Return" (click)="onReturnToMembers()"
          [disabled]="isReturnDisabled()"><icon-backward></icon-backward></button>
          <h2>{{currentStep}}/2</h2>
        </div>
        @switch (selectedMember) {
          @case (false) {
            <!-- Member selection -->
            <app-fee-pay-select-member [data]="personPage" [waiting]="readingMembers"
              (change)="onChangePay($event.target)" (selectPerson)="onSelectPerson($event)"
              (goToPage)="onGoToMembersPage($event)"
            (changeFilter)="onChangeActiveFilter($event)"></app-fee-pay-select-member>
          }
          @case (true) {
            <!-- Date selection -->
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" role="switch" id="switchPaid" [checked]="pay"
                [disabled]="saving" [attr.aria-disabled]="saving" (change)="onChangePay($event.target)">
                <label class="form-check-label" for="switchPaid">Pagada</label>
              </div>
              <!-- Form -->
              @switch (pay) {
                @case (true) {
                  <!-- Pay form -->
                  <assoc-fee-pay-form [waiting]="saving" [failures]="failures" [readonly]="!createPermission"
                    [person]="person" (save)="onSave($event)">
                  </assoc-fee-pay-form>
                }
                @case (false) {
                  <!-- Create unpaid form -->
                  <assoc-fee-creation-form [waiting]="saving" [failures]="failures" [readonly]="!createPermission"
                  [person]="person" (save)="onCreateUnpaid($event)"></assoc-fee-creation-form>
                }
              }
            }
          }
        </p-card>
      </div>
    </ui-article>