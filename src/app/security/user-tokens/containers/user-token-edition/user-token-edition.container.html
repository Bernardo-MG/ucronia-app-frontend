<div uiResponsiveShortColumns>
  <!-- Role -->
  <div class="mb-1">
    <!-- Info -->
    <p-card>
      <ng-template #header>
        <!-- Tabs -->
        <ul class="nav nav-tabs card-header-tabs">
          <li class="nav-item">
            <a class="nav-link" [class.active]="view === 'details'" aria-current="page" role="button"
              (click)="onChangeView('details')">Detalles</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" [class.active]="view === 'status'" aria-current="page" role="button"
              (click)="onChangeView('status')">Estado</a>
          </li>
        </ul>
      </ng-template>
      <ng-container [ngSwitch]="view">
        <ng-container *ngSwitchCase="'details'">
          <access-user-token-info [failures]="failures" [data]="data" [waiting]="waiting" />
          <ng-template #footer>
            <!-- Extend expiration button -->
            <button type="submit" name="Extend expiration" class="btn btn-primary" [uiWaiting]="waiting"
              [disabled]="!editEnabled" [attr.aria-disabled]="!editEnabled" data-bs-toggle="modal"
              [attr.data-bs-target]="editEnabled ? '#extendExpirationModal' : ''">Extender
              expiración</button>
          </ng-template>
        </ng-container>
        <ng-container *ngSwitchCase="'status'">
          <access-user-token-status [data]="data" />
          <ng-template #footer>
            <!-- Revoke button -->
            <button type="submit" name="Revoke" class="btn btn-primary" [uiWaiting]="waiting" [disabled]="!editEnabled"
              [attr.aria-disabled]="!editEnabled" data-bs-toggle="modal"
              [attr.data-bs-target]="editEnabled ? '#revokeModal' : ''">Revocar</button>
          </ng-template>
        </ng-container>
      </ng-container>
    </p-card>
  </div>
</div>

<!-- Modal for extending expiration -->
<ui-modal name="extendExpirationModal" title="Extender expiración" acceptText="Extender"
  (accept)="onExtendExpiration()">
  <p>Elige una nueva fecha</p>
  <form [formGroup]="extendExpirationForm" (ngSubmit)="onExtendExpiration()" class="needs-validation" novalidate>
    <input type="datetime-local" id="extendExpirationInput" class="form-control" formControlName="expirationDate">
  </form>
</ui-modal>

<!-- Modal confirmation for revoking -->
<ui-modal name="revokeModal" title="Revocar token" acceptText="Revocar" (accept)="onRevoke()">
  <p>¿Estás seguro de que quieres revocar el token?</p>
  <p class="text-warning"><small>Esta acción no se puede deshacer.</small></p>
</ui-modal>